# Run on a schedule
trigger: none
pr: none

jobs:
- job:  
  displayName: Step1
  pool: 
    vmImage: 'windows-latest'
  steps:
  - task: Bash@3
    displayName: Test
    inputs:
      targetType: 'inline'
      script: |
        # Write your commands here      
        echo 'Hello world'
  - task: NodeTool@0
    inputs:
      versionSource: 'spec'
      versionSpec: '18.x'
      
  - task: Bash@3
    displayName: Git Clone
    inputs:
      targetType: 'inline'
      script: |
        # Write your commands here      
        git clone https://github.com/zeromq/zeromq.js.git
      
  - task: Bash@3
    displayName: ls
    inputs:
      targetType: 'inline'
      workingDirectory: zeromq.js
      script: |
        ls
  
      
  - task: Bash@3 
    displayName: Download libsodium
    inputs:
      targetType: 'inline'
      script: |
        curl -o libsodium.release.zip https://download.libsodium.org/libsodium/releases/libsodium-1.0.18-stable-msvc.zip

      
  - task: Bash@3
    displayName: ls
    inputs:
      targetType: 'inline'
      script: |
        ls

  - task: ExtractFiles@1
    inputs:
      archiveFilePatterns: 'libsodium.release.zip'
      destinationFolder: 'libsodium.release'
      cleanDestinationFolder: true
      overwriteExistingFiles: false

      
  - task: Bash@3
    displayName: ls
    inputs:
      workingDirectory: libsodium.release
      targetType: 'inline'
      script: |
        ls
      
  - task: Bash@3
    displayName: ls
    inputs:
      targetType: 'inline'
      script: |
        cp libsodium.release/x64/Release/v142/dynamic/* zeromq.js
      
      
  - task: Bash@3
    displayName: ls
    inputs:
      workingDirectory: zeromq.js
      targetType: 'inline'
      script: |
        ls
  - task: Bash@3
    inputs:
      targetType: 'inline'
      workingDirectory: zeromq.js
      script: |
        npm install
  